# Восстановление золота из руды
Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Вам нужно:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

Чтобы выполнить проект, обращайтесь к библиотекам *pandas*, *matplotlib* и *sklearn.* Вам поможет их документация.
## Исходные данные от заказчика
### Задача

Необходимо смоделировать процесс восстановления золота из золотосодержащей руды.

Необходимо выбрать модель, подобрать её параметры для прогнозирования двух величин:
- эффективность обогащения чернового концентрата `rougher.output.recovery`;
- эффективность обогащения финального концентрата `final.output.recovery`.

Для выбора модели применять метрику sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

Метрика sMAPE для одной из величин вычисляется так:

$$ sMAPE = \dfrac{1}{N} \sum_{i=1}^{N} \dfrac{|y_i - \hat y_i|}{(|y_i| + |\hat y_i|) / 2} \times 100 \%$$

Итоговая метрика складывается из двух величин:

$$ sMAPE(total) = 25\% \times sMAPE(rougher) + 75\%  \times sMAPE(final)$$

Данные находятся в трёх файлах:
- `gold_recovery_train_new.csv` — обучающая выборка;
- `gold_recovery_test_new.csv` — тестовая выборка;
- `gold_recovery_full_new.csv` — исходные данные.

Данные индексируются датой и временем получения информации (признак `date`). 

Соседние по времени параметры часто похожи.

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

В вашем распоряжении сырые данные: их просто выгрузили из хранилища.

### Описание данных

*Технологический процесс*
- `Rougher feed` — исходное сырье
- `Rougher additions` (или `reagent additions`) — флотационные реагенты: *Xanthate, Sulphate, Depressant*
- `Xanthate` — ксантогенат (промотер, или активатор флотации);
- `Sulphate` — сульфат (на данном производстве сульфид натрия);
- `Depressant` — депрессант (силикат натрия).
- `Rougher process` (англ. «грубый процесс») — флотация
- `Rougher tails` — отвальные хвосты
- `Float banks` — флотационная установка
- `Cleaner process` — очистка
- `Rougher Au` — черновой концентрат золота
- `Final Au` — финальный концентрат золота

*Параметры этапов*
- `air amount` — объём воздуха
- `fluid levels` — уровень жидкости
- `feed size` — размер гранул сырья
- `feed rate` — скорость подачи

*Наименование признаков*
- `[этап].[тип_параметра].[название_параметра]`

Пример: `rougher.input.feed_ag`, то есть для этапа Флотация -> входные параметры -> содержание ЗОЛОТА в сырье

Возможные значения для блока `[этап]`:
- `rougher` — флотация
- `primary_cleaner` — первичная очистка
- `secondary_cleaner` — вторичная очистка
- `final` — финальные характеристики

Возможные значения для блока `[тип_параметра]`:
- `input` — параметры сырья
- `output` — параметры продукта
- `state` — параметры, характеризующие текущее состояние этапа
- `calculation` — расчётные характеристики

Данные индексируются датой и временем получения информации (признак `date`). Соседние по времени параметры часто похожи.

### План работы

- 1. Подготовка и предобработка данных
  - 1.1. Отрытие файлов и первичный анализ.
  - 1.2. Проверка эффективности обогащения.
  - 1.3. Анализ признаков, недоступных в тестовой выборке. 
  - 1.4. Предобработка данных.
  - 1.5. Вывод по разделу
- 2. Анализ данных
  - 2.1. Оценка изменения концентрации металлов (Au, Ag, Pb) на различных этапах очистки.
  - 2.2. Сравнение распределения размеров гранул сырья на обучающей и тестовой выборках.
  - 2.3. Исследование суммарной концентрации всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах.
  - 2.4. Вывод по разделу
- 3. Выбор и постройка модели
  - 3.1. Выделение признаков и целевых признаков.
  - 3.2. Реализация функции для вычисления итоговой sMAPE.
  - 3.3. Обучение разных моделей и оценка их качества кросс-валидацией.
  - 3.4. Выбор лучшей модели
  - 3.5. Проверка выбранной модели на тестовой выборке. 
  - 3.6. Проверка адекватности модели.
  - 3.7. Вывод по разделу
- 4. Общий вывод
